<?xml version="1.0"?>
<openerp>
    <data>
        <record model="ir.ui.view" id="view_sale_order_fastline_form">
            <field name="name">sale.order.fastline.form</field>
            <field name="model">sale.order.fastline</field>
            <field name="arch" type="xml">
                <form string="Fastline" version="7.0">        
                    <sheet>
                        <group col="4" colspan="4">
                           <field name="order_id" invisible="1"/>
                           <field name="product_id" />
                           <field name="product_uom_qty" />
                           <field name="price_unit" />                           
                        </group>
                    </sheet>        
                </form>
            </field>
        </record>
        <record model="ir.ui.view" id="view_sale_order_fastline_tree">
            <field name="name">sale.order.fastline.tree</field>
            <field name="model">sale.order.fastline</field>
            <field name="arch" type="xml">
                <tree string="Fastline" editable="bottom">        
                    <field name="order_id" invisible="1"/>
                    <field name="product_id" />
                    <field name="product_uom_qty" />
                    <field name="price_unit" />
                </tree>
            </field>
        </record>
    
        <record model="ir.ui.view" id="view_sale_order_fastline_page_form">
            <field name="name">sale.order.fastline.form</field>
            <field name="model">sale.order</field>
            <field name="inherit_id" ref="sale.view_order_form"/>
            <field name="arch" type="xml">
                <xpath expr="/form/header/field[@name='state']" position="before">
                    <field name="fast_order" invisible="1" />
                    <button name="show_fastorder" string="Fast order" type="object" attrs="{'invisible':[('fast_order','=',True)]}"/>
                </xpath>
                <xpath expr="//notebook/page[1]" position="after">
                    <page string="Fast line" attrs="{'invisible':[('fast_order','=',False)]}">
                        <group colspan="4">
                            <button name="create_real_line" string="Create real line" type="object" />
                            <separator string="Fast line:" colspan="4" />
                            <field name="fastline_ids" colspan="4"/>
                        </group>
                    </page>
                </xpath>
            </field>
        </record>

        <record model="ir.ui.view" id="view_fast_sale_order_form">
            <field name="name">sale.order.fastline.form</field>
            <field name="model">sale.order</field>
            <field name="arch" type="xml">        
                <form string="Ordine di vendita" version="7.0">
	                <header>
		                <!--<button name="invoice_recreate" states="invoice_except" string="Ricrea Fattura" modifiers="{'invisible': [['state', 'not in', ['invoice_except']]]}"/>
		                <button name="invoice_corrected" states="invoice_except" string="Ignora eccezione" modifiers="{'invisible': [['state', 'not in', ['invoice_except']]]}"/>
		                <button name="ship_recreate" states="shipping_except" string="Ricrea l'ordine di consegna" modifiers="{'invisible': [['state', 'not in', ['shipping_except']]]}"/>
		                <button name="ship_corrected" states="shipping_except" string="Ignora eccezione" modifiers="{'invisible': [['state', 'not in', ['shipping_except']]]}"/>-->
		                <button name="action_quotation_send" string="Invia tramite Email" type="object" states="draft" class="oe_highlight" modifiers="{'invisible': [['state', 'not in', ['draft']]]}"/>
		                <button name="action_quotation_send" string="Invia tramite Email" type="object" states="sent,progress,manual" modifiers="{'invisible': [['state', 'not in', ['sent', 'progress', 'manual']]]}"/>
		                <button name="print_quotation" string="Stampa" type="object" states="draft" class="oe_highlight" modifiers="{'invisible': [['state', 'not in', ['draft']]]}"/>
		                <button name="print_quotation" string="Stampa" type="object" states="sent,progress,manual" modifiers="{'invisible': [['state', 'not in', ['sent', 'progress', 'manual']]]}"/>
		                <button name="action_button_confirm" states="draft" string="Conferma Ordine" type="object" modifiers="{'invisible': [['state', 'not in', ['draft']]]}"/>
		                <button name="action_button_confirm" states="sent" string="Conferma Ordine" class="oe_highlight" type="object" modifiers="{'invisible': [['state', 'not in', ['sent']]]}"/>
		                <!--<button name="action_view_invoice" string="Visualizza Fattura" type="object" class="oe_highlight" attrs="{'invisible': [('invoice_exists', '=', False)]}" modifiers="{'invisible': [['invoice_exists', '=', false]]}"/>
		                <field name="picking_ids" invisible="1" modifiers="{'invisible': true, 'readonly': true}"/>
		                <button name="action_view_delivery" string="Vedi ordine di consegna" type="object" class="oe_highlight" attrs="{'invisible': ['|',('picking_ids','=',False),('picking_ids','=',[])]}" modifiers="{'invisible': ['|', ['picking_ids', '=', false], ['picking_ids', '=', []]]}"/>
		                <button name="action_view_ddt" string="Vedi DdT" type="object" class="oe_highlight" attrs="{'invisible': ['|',('picking_ids','=',False),('picking_ids','=',[])]}" modifiers="{'invisible': ['|', ['picking_ids', '=', false], ['picking_ids', '=', []]]}"/>
		                <button name="416" string="Crea fattura" type="action" states="manual" class="oe_highlight" modifiers="{'invisible': [['state', 'not in', ['manual']]]}"/>
		                <button name="copy_quotation" states="cancel" string="Nuova Copia del Preventivo" type="object" modifiers="{'invisible': [['state', 'not in', ['cancel']]]}"/>-->
		                <button name="cancel" states="draft,sent" string="Annulla il preventivo" modifiers="{'invisible': [['state', 'not in', ['draft', 'sent']]]}"/>
		                <button name="action_cancel" states="manual,progress" string="Annulla Ordine" type="object" modifiers="{'invisible': [['state', 'not in', ['manual', 'progress']]]}"/>
		                <!--<button name="ship_cancel" states="shipping_except" string="Annulla Ordine" modifiers="{'invisible': [['state', 'not in', ['shipping_except']]]}"/>
		                <button name="invoice_cancel" states="invoice_except" string="Annulla Ordine" modifiers="{'invisible': [['state', 'not in', ['invoice_except']]]}"/>
		                <field name="fast_order" invisible="1" modifiers="{'invisible': true}"/>
		                <button name="show_fastorder" string="Fast order" type="object" attrs="{'invisible':[('fast_order','=',True)]}" modifiers="{'invisible': [['fast_order', '=', true]]}"/>-->
		                <field name="state" widget="statusbar" statusbar_visible="draft,sent,progress,done" statusbar_colors="{'shipping_except':'red','invoice_except':'red','waiting_date':'blue'}" modifiers="{'readonly': true}"/>
		                
		                <div style="background-color: red;text-align: center;font-weight:bold;color:white;">
			                <field name="uncovered_alert" nolabel="1" attrs="{'invisible': [('uncovered_payment', '=', False)]}" class="oe_color_red" modifiers="{'invisible': [['uncovered_payment', '=', false]], 'readonly': true}"/>
		                </div>
		                <field name="uncovered_payment" invisible="1" modifiers="{'invisible': true}"/>
	                </header>
	                <sheet>
		                <h1>
			                <label string="Preventivo" attrs="{'invisible': [('state','not in',('draft','sent'))]}" modifiers="{'invisible': [['state', 'not in', ['draft', 'sent']]]}"/>
			                <label string="Ordine di vendita" attrs="{'invisible': [('state','in',('draft','sent'))]}" modifiers="{'invisible': [['state', 'in', ['draft', 'sent']]]}"/>
			                <field name="uncovered_state" invisible="1" modifiers="{'invisible': true, 'readonly': true}"/>
			                <div style="background-color: red;text-align: center;font-weight:bold;color:white;">
				                <field name="empty" readonly="1" nolabel="1" attrs="{'invisible': [('uncovered_state', '!=', 'red')]}" class="oe_color_red" modifiers="{'invisible': [['uncovered_state', '!=', 'red']], 'readonly': true}"/>
			                </div>
			                <div style="background-color: yellow;text-align: center;font-weight:bold;color:white;">
				                <field name="empty" readonly="1" nolabel="1" attrs="{'invisible': [('uncovered_state', '!=', 'yellow')]}" class="oe_color_red" modifiers="{'invisible': [['uncovered_state', '!=', 'yellow']], 'readonly': true}"/>
			                </div>
			                <div style="background-color: green;text-align: center;font-weight:bold;color:white;">
				                <field name="empty" readonly="1" nolabel="1" attrs="{'invisible': [('uncovered_state', '!=', 'green')]}" class="oe_color_red" modifiers="{'invisible': [['uncovered_state', '!=', 'green']], 'readonly': true}"/>
			                </div>
			                <div style="background-color: black;text-align: center;font-weight:bold;color:white;">
				                <field name="empty" readonly="1" nolabel="1" attrs="{'invisible': [('uncovered_state', '!=', 'black')]}" class="oe_color_red" modifiers="{'invisible': [['uncovered_state', '!=', 'black']], 'readonly': true}"/>
			                </div>
			                <field name="name" class="oe_inline" readonly="1" modifiers="{'readonly': true, 'required': true}"/>
			                <!--<button name="nothing" string="" type="object" icon="gtk-yes" attrs="{'invisible': [('all_produced','=',False)]}" modifiers="{'invisible': [['all_produced', '=', false]]}"/>
			                <field name="print" invisible="1" modifiers="{'invisible': true}"/>
			                <button name="to_print" string="Da stampare" icon="gtk-print" type="object" attrs="{'invisible':[('print','=', True)]}" modifiers="{'invisible': [['print', '=', true]]}"/>
			                <button name="no_print" string="Annulla stampa" icon="gtk-ok" type="object" attrs="{'invisible':[('print','=', False)]}" modifiers="{'invisible': [['print', '=', false]]}"/>-->
			                <field name="accounting_order" invisible="1" modifiers="{'invisible': true}"/>
		                </h1>
		                <group>
			                <group>
				                <field name="partner_id" on_change="onchange_partner_id(partner_id, context)" domain="[('customer','=',True),('is_company','=',True),('is_address','=',False)]" context="{'search_default_customer':1, 'show_address': 1}" options="{'always_reload': True}" attrs="{'readonly': [('state','in',('done'))]}" modifiers="{'readonly': [['state', 'in', 'done']], 'required': true}"/>
				                <!--<field name="stock_picking_ids" attrs="{'invisible': [('state','not in',('confirmed','progress','manual','done'))]}" modifiers="{'invisible': [['state', 'not in', ['confirmed', 'progress', 'manual', 'done']]]}"/>-->
				                <group name="destination_parameters" colspan="2" col="2">
					                <field name="destination_partner_id" domain="[('parent_id','=',partner_id),('is_address','=',True)]" context="{'show_address':True}" modifiers="{}"/>
					                <field name="invoice_partner_id" domain="[('is_company','=',True),('is_address','=',False)]" context="{'show_address':True}" modifiers="{}"/>
				                </group>
				                <field name="partner_invoice_id" context="{'default_type':'invoice'}" invisible="1" modifiers="{'invisible': true, 'readonly': [['state', 'not in', ['draft', 'sent']]], 'required': true}"/>
				                <field name="partner_shipping_id" on_change="onchange_delivery_id(company_id, partner_id, partner_shipping_id, fiscal_position)" context="{'default_type':'delivery'}" invisible="1" modifiers="{'invisible': true, 'readonly': [['state', 'not in', ['draft', 'sent']]], 'required': true}"/>
				                <!--<field name="project_id" context="{'partner_id':partner_invoice_id, 'manager_id': user_id, 'default_pricelist_id':pricelist_id, 'default_name':name, 'default_type': 'contract'}" domain="[('type','in',['view','normal','contract'])]" invisible="1" modifiers="{'invisible': true, 'readonly': [['state', 'not in', ['draft', 'sent']]]}"/>-->
			                </group>
			                <group>
				                <field name="date_order" modifiers="{'readonly': [['state', 'not in', ['draft', 'sent']]], 'required': true}"/>
				                <!--<field name="pricelist_order" modifiers="{}"/>-->
				                <field name="date_valid" modifiers="{}"/>
				                <field name="client_order_ref" modifiers="{}"/>
				                <field name="warehouse_id" on_change="onchange_warehouse_id(warehouse_id)" options="{'no_create': True}" modifiers="{'required': true}"/>
				                <field domain="[('type','=','sale')]" name="pricelist_id" on_change="onchange_pricelist_id(pricelist_id,order_line)" attrs="{'readonly': [('state','in',('done'))]}" modifiers="{'readonly': [['state', 'in', 'done']], 'required': true}"/>
				                <!--<button name="655" string="Delivery wizard" type="action" colspan="2" context="{'default_order_id': active_id}" attrs="{'invisible':[('state', 'in', ('draft', 'sent', 'cancel'))]}" modifiers="{'invisible': [['state', 'in', ['draft', 'sent', 'cancel']]]}"/>-->
				                <field name="currency_id" invisible="1" modifiers="{'invisible': true, 'readonly': true, 'required': true}"/>
			                </group>
		                </group>
		                <group name="extra_parameters" colspan="4" col="4">
			                <field name="quotation_model" modifiers="{}"/>
		                </group>
		                <field name="portal_payment_options" class="view_portal_payment_options" invisible="1" modifiers="{'invisible': true, 'readonly': true}"/>
		                <field name="linked" invisible="1" modifiers="{'invisible': true}"/>
		                <button name="button_create_order_outsource" icon="gtk-convert" string="Create outource order" type="object" attrs="{'invisible': ['|',('state', 'in', ('draft','cancel','sent')),('linked', '=', True)]}" modifiers="{'invisible': ['|', ['state', 'in', ['draft', 'cancel', 'sent']], ['linked', '=', true]]}"/>
		                <button name="nothing" icon="gtk-yes" string="Ousourced!" type="object" attrs="{'invisible': ['|',('state', 'in', ('draft','cancel','sent')),('outsource', '=', False)]}" modifiers="{'invisible': ['|', ['state', 'in', ['draft', 'cancel', 'sent']], ['outsource', '=', false]]}"/>
		                <notebook>
		                
			                <page string="Righe Ordine">
				                <!--<group colspan="4" col="4">
					                <field name="forecasted_production_id" attrs="{'invisible':[('forecasted_production_id', '=', False)]}" modifiers="{'invisible': [['forecasted_production_id', '=', false]]}"/>
				                </group>
				                <field name="all_produced" invisible="1" modifiers="{'invisible': true}"/>-->
				                <field name="order_line" context="{'default_date_deadline': date_deadline, 'partner_id': partner_id}" attrs="{'readonly':[('state', 'in', ('cancel'))]}" modifiers="{'readonly': [['state', 'in', 'cancel']]}"/>
				                <button name="open_csv_order" string="Original order" type="object" icon="gtk-justify-fill"/>
				                <group class="oe_subtotal_footer oe_right" colspan="2" name="sale_total">
					                <field name="amount_untaxed" widget="monetary" options="{'currency_field': 'currency_id'}" modifiers="{'readonly': true}"/>
					                <field name="amount_tax" widget="monetary" options="{'currency_field': 'currency_id'}" modifiers="{'readonly': true}"/>
					                <div class="oe_subtotal_footer_separator oe_inline">
						                <label for="amount_total"/>
						                <button name="button_dummy" states="draft,sent" string="(aggiorna)" type="object" class="oe_edit_only oe_link" modifiers="{'invisible': [['state', 'not in', ['draft', 'sent']]]}"/>
					                </div>
					                <field name="amount_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}" modifiers="{'readonly': true}"/>
				                </group>
				                <group style="width: 65%">
					                <label for="carrier_id"/>
					                <div>
						                <field name="carrier_id" context="{'order_id':active_id or False}" class="oe_inline" modifiers="{}"/>
						                <button name="delivery_set" string="Add in Quote" type="object" class="oe_edit_only" attrs="{'invisible':['|',('carrier_id','=',False),('state','not in',('draft','sent'))]}" modifiers="{'invisible': ['|', ['carrier_id', '=', false], ['state', 'not in', ['draft', 'sent']]]}"/>
						                <br/>
						                <label string="If you don't 'Add in Quote', the exact price will be computed when invoicing based on delivery order(s)." class="oe_edit_only" attrs="{'invisible':['|',('carrier_id','=',False),('state','not in',('draft','sent'))]}" modifiers="{'invisible': ['|', ['carrier_id', '=', false], ['state', 'not in', ['draft', 'sent']]]}"/>
					                </div>
				                </group>
				                <div class="oe_clear"/>
				                <field name="note" class="oe_inline" placeholder="Termini e condizioni..." modifiers="{}"/>
			                </page>
			                
			                <page string="Data ordine">
				                <group colspan="2" col="5">
					                <field name="date_confirm" modifiers="{}"/>
					                <field name="date_deadline" modifiers="{}"/>
					                <button name="button_force_all_deadline_date" string="Forza tutte le linee" colspan="1" type="object"/>
					                <newline/>
					                <field name="date_booked_confirmed" modifiers="{}"/>
					                <field name="date_booked" attrs="{'required': [('date_booked_confirmed','=',True)]}" modifiers="{'required': [['date_booked_confirmed', '=', true]]}"/>
					                <newline/>
					                <field name="date_delivery_confirmed" modifiers="{}"/>
					                <field name="date_delivery" attrs="{'required': [('date_delivery_confirmed','=',True)]}" modifiers="{'required': [['date_delivery_confirmed', '=', true]]}"/>
				                </group>
			                </page>
			                
			                <page string="Outsource">
				                <group colspan="4" col="4">
					                <separator string="Original order:" colspan="4" attrs="{'invisible': [('outsource_order','=',False)]}" modifiers="{'invisible': [['outsource_order', '=', false]]}"/>
					                <field name="outsource_order" colspan="4" nolabel="1" widget="html" attrs="{'invisible': [('outsource_order','=',False)]}" readonly="1" modifiers="{'invisible': [['outsource_order', '=', false]], 'readonly': true}"/>
					                <separator string="Outsource order esit:" colspan="4" attrs="{'invisible': [('outsource_esit','=',False)]}" modifiers="{'invisible': [['outsource_esit', '=', false]]}"/>
					                <field name="outsource_esit" colspan="4" nolabel="1" widget="html" attrs="{'invisible': [('outsource_esit','=',False)]}" readonly="1" modifiers="{'invisible': [['outsource_esit', '=', false]], 'readonly': true}"/>
					                <field name="outsource" invisible="1" modifiers="{'invisible': true}"/>
				                </group>
			                </page>
			                
			                <page string="Note">
				                <group colspan="4" col="4">
					                <field name="text_note_pre_id" on_change="onchange_note(text_note_pre_id,'text_note_pre')" colspan="2" domain="[('object','=','sale.order')]" context="{'default_object':'sale.order'}" modifiers="{}"/>
					                <field name="text_note_post_id" on_change="onchange_note(text_note_post_id,'text_note_post')" colspan="2" domain="[('object','=','sale.order')]" context="{'default_object':'sale.order'}" modifiers="{}"/>
					                <separator string="Note (pre sale line)" colspan="2"/>
					                <separator string="Note (post sale line)" colspan="2"/>
					                <field name="text_note_pre" colspan="2" nolabel="1" modifiers="{}"/>
					                <field name="text_note_post" colspan="2" nolabel="1" modifiers="{}"/>
				                </group>
			                </page>
			                
			                <page string="Fast line" attrs="{'invisible':[('fast_order','=',False)]}" modifiers="{'invisible': [['fast_order', '=', false]]}">
				                <group colspan="4">
					                <button name="create_real_line" string="Create real line" type="object"/>
					                <separator string="Fast line:" colspan="4"/>
					                <field name="fastline_ids" colspan="4" modifiers="{}"/>
				                </group>
			                </page>
			                
			                <page string="Altre informazioni">
				                <group>
					                <group name="logistics">
						                <field name="incoterm" widget="selection" modifiers="{}"/>
						                <field name="picking_policy" required="True" modifiers="{'readonly': [['state', 'not in', ['draft', 'sent']]], 'required': true}"/>
						                <field name="order_policy" modifiers="{'readonly': [['state', 'not in', ['draft', 'sent']]], 'required': true}"/>
					                </group>
					                <group name="sales_person">
						                <field name="user_id" context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'account.group_account_invoice', 'base.group_sale_salesman_all_leads']}" modifiers="{}"/>
						                <field name="categ_ids" widget="many2many_tags" modifiers="{}"/>
						                <field name="mx_agent_id" modifiers="{}"/>
						                <field name="section_id" options="{'no_create': True}" invisible="1" modifiers="{'invisible': true}"/>
						                <field name="origin" modifiers="{}"/>
						                <field name="campaign_id" modifiers="{}"/>
						                <field name="medium_id" modifiers="{}"/>
						                <field name="source_id" modifiers="{}"/>
					                </group>
					                <group name="sale_pay">
						                <field name="payment_term" options="{'no_create': True}" modifiers="{}"/>
						                <field name="payment_term_id" invisible="1" modifiers="{'invisible': true}"/>
						                <field name="bank_account_id" domain="[('partner_id', '=', partner_id)]" modifiers="{}"/>
						                <field name="bank_account_company_id" domain="[('partner_id', '=', company_id)]" modifiers="{}"/>
						                <field name="return_id" widget="selection" modifiers="{}"/>
						                <field name="bank_id" modifiers="{}"/>
						                <field name="fiscal_position" options="{'no_create': True}" on_change="onchange_fiscal_position(fiscal_position, order_line, context)" modifiers="{}"/>
						                <field name="company_id" readonly="True" modifiers="{'readonly': true}"/>
					                </group>
					                <group>
						                <field name="invoiced" modifiers="{'readonly': true}"/>
						                <field name="shipped" modifiers="{'readonly': true}"/>
						                <field name="invoice_exists" invisible="1" modifiers="{'invisible': true, 'readonly': true}"/>
						                <field name="invoice_exists" invisible="1" modifiers="{'invisible': true, 'readonly': true}"/>
					                </group>
				                </group>
			                </page>
			                
			                <page string="Informazioni spedizione">
				                <group string="Informazioni spedizione">
					                <group>
						                <field name="goods_description_id" widget="selection" modifiers="{}"/>
						                <field name="carriage_condition_id" widget="selection" modifiers="{}"/>
						                <field name="transportation_reason_id" widget="selection" modifiers="{}"/>
						                <field name="transportation_method_id" widget="selection" modifiers="{}"/>
						                <field name="parcels" modifiers="{}"/>
						                <button name="update_parcels_event" string="Auto counter" type="object"/>
						                <newline/>
						                <field name="parcels_note" nolabel="1" colspan="2" modifiers="{}"/>
					                </group>
					                <group>
						                <field name="create_ddt" modifiers="{}"/>
					                </group>
				                </group>
				                
				                <!--<group string="DdT collegati">
					                <field name="ddt_ids" nolabel="1" modifiers="{'readonly': true}"/>
				                </group>-->
			                </page>
		                </notebook>
	                </sheet>
	                <div class="oe_chatter">
		                <field name="message_follower_ids" widget="mail_followers" modifiers="{}"/>
		                <field name="message_ids" widget="mail_thread" modifiers="{}" options="{'display_log_button': true}"/>
	                </div>
                </form>        
            </field>
        </record>        
    </data>
</openerp>

